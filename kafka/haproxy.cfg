
global
    log stdout format raw local0
    stats socket /tmp/haproxy.sock mode 660 level admin expose-fd listeners
    stats timeout 30s
    maxconn 4096
    user haproxy
    group haproxy
    daemon

defaults
    log global
    option tcplog
    timeout connect 5000ms
    timeout client  50000ms
    timeout server  50000ms

frontend kafka_tcp
    bind :80
    mode tcp
    default_backend kafka_backend

backend kafka_backend
    mode tcp
    balance roundrobin
    server kafka1 kafka1:9092 check
    server kafka2 kafka2:9093 check
    server kafka3 kafka3:9094 check

frontend prometheus
    bind :8405
    mode http
    http-request use-service prometheus-exporter
    no log
